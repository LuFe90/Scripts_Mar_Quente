--Consulta a NFe de Faturamento
select FILIAL
,NF_SAIDA
,SERIE_NF
,STATUS_NFE
,LOG_STATUS_NFE
,CHAVE_NFE
,PROTOCOLO_AUTORIZACAO_NFE
,DATA_AUTORIZACAO_NFE
,PROTOCOLO_CANCELAMENTO_NFE
,MOTIVO_CANCELAMENTO_NFE
,DATA_CANCELAMENTO
,NOTA_CANCELADA
,QTDE_CANCELADA
,VALOR_CANCELADO
,NOME_CLIFOR
,OBS
,CODIGO_CLIENTE_VAREJO
,TIPO_EMISSAO_NFE
,REGISTRO_DPEC
,DATA_REGISTRO_DPEC
,DATA_CONTINGENCIA
,JUSTIFICATIVA_CONTINGENCIA
,DATA_HORA_EMISSAO 
FROM FATURAMENTO
WHERE NF_SAIDA IN ('024237') AND FILIAL = 'MAR QUENTE - GANGSTER' AND SERIE_NF = '51'

/*
--Atualiza Status para AUTORIZADA
BEGIN TRAN
UPDATE FATURAMENTO SET
PROTOCOLO_AUTORIZACAO_NFE = '242240031186675'
,DATA_AUTORIZACAO_NFE = '20240607 15:14:04'
,STATUS_NFE = '5'
,LOG_STATUS_NFE = '0'
WHERE NF_SAIDA IN ('024237') 
AND FILIAL = 'MAR QUENTE - GANGSTER'

COMMIT
*/

/* Atualiza Status para CANCELADA
BEGIN TRAN
UPDATE FATURAMENTO SET 
	STATUS_NFE = '49'
	,LOG_STATUS_NFE = '0'
	,DATA_CANCELAMENTO = '20240603 14:01:00'
	,PROTOCOLO_CANCELAMENTO_NFE = '214000535201524'
	,MOTIVO_CANCELAMENTO_NFE = 'Rejeicao: NF-e ja esta cancelada na base de dados da SEFAZ [nRec:214000535201524]'
	,NOTA_CANCELADA = '1'
	,PROTOCOLO_AUTORIZACAO_NFE = '214000535201524'
	,DATA_AUTORIZACAO_NFE = '20240603 14:01:00'
WHERE 
	NF_SAIDA IN ('000000375','000000376','000000377','000000378')
AND SERIE_NF = '4'
AND FILIAL = 'MAR QUENTE - GANGSTER'

COMMIT
*/

/*
--Atualiza Status para N√ÉO ENVIADO
BEGIN TRAN
UPDATE FATURAMENTO SET
	STATUS_NFE = '4'
	,LOG_STATUS_NFE = '99'
WHERE NF_SAIDA IN ('024237') 
AND FILIAL = 'MAR QUENTE - GANGSTER'
AND SERIE_NF = '51'

COMMIT
*/
