--Consulta Produtos no eCatalogo
--O que tiver COD_FILIAL = NULL -> deletar
--A filial deve ser verificada com o ERP, caso estiver divergente, alterar

SELECT * FROM MQ_INTEGRACAO_eCATALOGOS_LOJAS_PRODUTOS
WHERE PRODUTO IN (
		'10.16.3915'
		,'29.09.0434'
		,'11.24.2286'
		,'10.16.2538'
		,'29.08.1329'
		,'11.24.2089'
		,'29.08.0919'
		,'11.24.3533'
		,'10.16.2977'
		,'10.16.2614'
		,'10.10.0122'
		,'11.24.3532'
		,'14.07.1129'
		,'14.11.0361'
		,'87.09.0257'
		,'11.24.3532'
		,'10.10.0122'
		,'14.07.1129'
	)
--AND COD_FILIAL IS NULL 
ORDER BY 5, 2

/*
BEGIN TRAN
DELETE FROM MQ_INTEGRACAO_eCATALOGOS_LOJAS_PRODUTOS 
WHERE PRODUTO = '29.08.0919'
AND COD_FILIAL IS NULL
COMMIT
*/
/*
BEGIN TRAN
UPDATE MQ_INTEGRACAO_eCATALOGOS_LOJAS_PRODUTOS SET COD_FILIAL = '000056'
WHERE PRODUTO = '14.07.1129'
COMMIT
*/

--Consulta Controle de Estoque
SELECT * FROM MQ_ECATALOGOS_ESTOQUE_CONTROL
WHERE COD_FILIAL NOT IN ('000056')

/*
BEGIN TRAN
DELETE FROM MQ_ECATALOGOS_ESTOQUE_CONTROL
WHERE COD_FILIAL NOT IN ('000056')
COMMIT
*/

--Consulta fila para integraÃ§Ã£o
SELECT * FROM MQ_INTEGRACAO_eCATALOGOS_LOJAS
WHERE CHAVE IN (
		'10.16.3915'
		,'29.09.0434'
		,'11.24.2286'
		,'10.16.2538'
		,'29.08.1329'
		,'11.24.2089'
		,'29.08.0919'
		,'11.24.3533'
		,'10.16.2977'
		,'10.16.2614'
		,'10.10.0122'
		,'11.24.3532'
		,'14.07.1129'
		,'14.11.0361'
		,'87.09.0257'
		,'11.24.3532'
		,'10.10.0122'
		,'14.07.1129'
	)

/*
BEGIN TRAN
UPDATE MQ_INTEGRACAO_eCATALOGOS_LOJAS SET ACAO = 'I'
WHERE CHAVE = '14.11.0361'
COMMIT
*/

--Consulta LOG do Integrador

--Por Modulo
SELECT * FROM MQ_LOG_INTEGRACAO_eCATALOGOS_LOJAS
WHERE MODULO = 'ESTOQUE'
AND DATA_INTEGRACAO >= '20250430'

--Por Produto
SELECT * FROM MQ_LOG_INTEGRACAO_eCATALOGOS_LOJAS
WHERE MODULO = 'PRODUTOS'
AND CHAVE IN (
		'11.24.3533'
	)
AND DATA_INTEGRACAO >= '20250430'
order by 3 desc
